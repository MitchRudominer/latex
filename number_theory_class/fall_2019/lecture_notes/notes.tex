\documentclass[oneside,12pt]{amsart}

\usepackage{amsmath,amssymb,latexsym,eucal,amsthm}

\input{mathdefs}
\input{theoremstyles}

\pagestyle{plain}

\begin{document}

\title{Lecture Notes \\ Math 310, Elementary Number Theory \\ Fall 2019}
\author{Mitch Rudominer}

\maketitle

\tableofcontents

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newpage

\section{What is this class about? A whirlwind tour}

Elementary number theory is the theory of the integers.

$\Z = \singleton{\cdots, -3, -2, -1, 0, 1, 2, 3, \cdots} = $ the set of \emph{integers}.

Here is a quick peek at some ideas we will learn in this class. We'll zip through this quickly. Don't
worry if you don't fully understand the contents of this section yet (or understand it at all).
We'll cover all of this carefully later on. Here I'm just trying
to give you a flavor of the material you will learn in this class.

\begin{definition}[The $\bmod$ operator]
\label{ModOperatorTake1}
Let $a$ and $b$ be positive integers. Then $a \bmod b$ means the remainder when $a$ is divided by $b$.
\end{definition}

For example $7\bmod 3 = 1$, $8\bmod 2 = 0$, $5\bmod 8 = 5$.

\begin{definition} $\Z_n$ will refer to the ring of integers mod n. \end{definition}

This means that $\Z_n$ consists of the set of non-negative integers less than $n$ along
with two binary operations $\dotplus$, $\dottimes$ defined by

$$a \dotplus b = (a + b) \bmod n \text{ and } a \dottimes b = (a \times b) \bmod n.$$

Note that rather than writing $a\dotplus b$ and $a\dottimes b$ we will often just write
$a+b$ and $a\times b$ or $a\cdot b$ or $a b$ and say that we are doing arithmetic \emph{in $\Z_n$}.

For example $\Z_{10} = \singleton{0,1,2,3,4,5,6,7,8,9}$ under addition and multiplication $\bmod$ 10. This means for example that in $\Z_{10}$,
$6 \times 7 = 2$ because $42 \bmod 10 = 2$, and $4 + 9 = 3$ because $13 \bmod 10 = 3$.

In $\Z_{10}$ notice that some numbers have multiplicative inverses and some do not. For
example in $\Z_{10}, 3 \times 7 = 1$ so $3$ and $7$ are multiplicative inverses. But $4$ does not have any
multiplicative inverse in $\Z_{10}$ because the multiples of $4$ in $\Z_{10}$ are $4, 8, 2, 6, 0$ and so
$1$ is not a multiple of $4$ and so there is nothing you can multiply $4$ by to get $1$ and so
$4$ does not have a multiplicative inverse in $\Z_{10}$.

If an element of $\Z_{10}$ has an inverse then it is called a \emph{unit}.
So above we saw that in $\Z_{10}$, 3 and 7 are units but 4 is not.
Since $1\times 1 = 1$, 1 is always a unit in any $\Z_n$.
The set of all units of $\Z_{n}$ is written $\Z^*_{n}$.
You can check that $\Z^*_{10} = \singleton{1,3,7,9}$.

You can check that $\Z^*_{10}$ is closed under multiplication. That is, in $\Z_{10}$, if
$a,b$ are units then so is $ab$. For example 3 and 9 are units and in $\Z_{10}$, $3\times 9 = 7$
and $7$ is a unit. So if you take any $a\in \Z^*_{10}$, then all of the powers of $a$, $a^n$, are
also in $\Z^*_{10}$.

Consider the powers of $9$ in $\Z_{10}$. $9^2=1, 9^3 = 9, 9^4 =1, 9^5 = 9, \cdots$. So the only
powers of $9$ in $\Z_{10}$ are $9$ and $1$.

Now consider the powers of $3$ in $\Z_{10}$. $3^2=9, 3^3 = 7, 3^4 =1, 3^5 = 9, 3^6 = 7, \cdots$.
So the powers of $3$ in $\Z_{10}$ are $\singleton{1,3,7,9}$, i.e. all of $\Z^*_{10}$.

Because $3\in Z^*_{10}$ and all of the elements of $\Z^*_{10}$ can be written as
powers of $3$, we say
that $3$ is a \emph{generator} of $\Z^*_{10}$ and that 3 is a \emph{primitive root} $\bmod$ 10 or a primitive
root of 10. As we saw above, 9 is not a primitive root of 10 but 3 is.

Now let's play that whole game with $\Z_8$ instead of $\Z_{10}$.
$\Z_8 = \singleton{0,1,2,3,4,5,6,7}$ under addition and multiplication $\bmod$ 8.
$\Z^*_{8} = \singleton{1,3,5,7}$. Notice that $1^2 = 1, 3^2 = 1, 5^2 = 1, 7^2 = 1$. This means
that none of $\singleton{1,3,5,7}$ is a generator of $\Z^*_{8}$. $\Z^*_{8}$ does not have any
generators. 8 does not have any primitive roots.

Which integers have primitive roots? With effort you could check the following:
3 yes, 4 yes, 5 yes, 6 yes, 7 yes, 8 no, 9 yes, 10 yes, 11 yes, 12 no, 13 yes, 14 yes, 15 no,
16 no, 17 yes, 18 yes, 19 yes 20 no.

What's going on here? What is the pattern of which integers have primitive roots? After taking
 this
class, you will have a full and deep understanding of this question.

\newpage

\section{Axioms for the Integers}

\textbf{Question} Find the prime factorization of 20.

\textbf{Answer} $20=2^2 \times 5$?

\textbf{Question} Is this the only prime factorization of 20?

\textbf{Answer} Yes.

\textbf{Question} Find the prime factorization of 54.

\textbf{Answer} $54=2\times 3^3$?

\textbf{Question} Is this the only prime factorization of 54?

\textbf{Answer} Yes.

\begin{theorem}[The Fundamental Theorem Of Arithmetic] For all integers $n>1$, $n$ may be expressed
as a product of powers of primes: $n=p_1^{e_1}p_2^{e_2}\cdots p_k^{e_k}$, where each
$p_i$ is a prime number and each $e_i\geq 1$. This expression is unique up to the order of
the primes.
\end{theorem}

Our first major goal of the course will be to prove the Fundamental Theorem of Arithmetic. Think
for a moment about how you would prove it yourself.

One problem that arises immediately is this: The fact that you can factor integers into prime numbers is something we learn
early in school. If we are going to prove this fact then obviously we are not allowed to assume this fact. But this is
one of the ``basic" facts about the integers. If we are not allowed to assume this basic fact then which other basic facts
are we not allowed to assume? If we don't know what we are allowed to assume, then how could we possibly prove anything?

To resolve this problem we will write down exactly what it is we are planning to assume about the integers. We will call these assumptions the Axioms of the Integers. Everything else in
this course will be derived from these axioms.

\subsection{Axioms about addition}
The integers form an abelian group under addition.

\begin{enumerate}
\item $+$ is associative: $\forall n,m,k\in\Z, (n+m)+k=n+(m+k)$
\item $+$ is commutative: $\forall n,m\in\Z, n+m=m+n$
\item 0 is an additive identity: $\forall n\in\Z, n+0 = 0+n = n$
\item Every integer has an additive inverse: For all integers $n$ there exists another
integer called $-n$ such that $n + (-n) = (-n) + n = 0$.
\end{enumerate}

We write $a-b$ instead of $a + (-b)$.

\begin{remark}
The following facts are true and we do not need axioms for them:
\begin{itemize}
\item If $n=m$ then $n+k = m+k$.
\item If $n=m$ then $-n = -m$.
\end{itemize}
The reason we do not need axioms for these facts is that they follow from
the \emph{logical axioms} about the meaning of $=$. If $n$ and $m$ are different
names for the same thing, then, of course $-n$ and $-m$ are different names
for the same thing and $n+k$ and $m+k$ are names for the same thing.
\end{remark}

\begin{homework}[Bringing to the other side]
Using the above axioms, show that for all integers $a,b,c$, if
$a+b = c$ then $a = c - b$. Similarly, if $a-b=c$ then $a=b+c$.
Thus we are allowed to perform the usual operation of bringing a
term to the other side of the equation and changing its sign.
\end{homework}

\begin{homework}
\label{ZeroIsUnique}
Using the above axioms, show that $0$ is the only additive identity.  Even
stronger, show that for all integers $n$ and $m$, if $n+m=n$ then $m=0$.
\end{homework}

\begin{homework}
Using the above axioms, show that additive inverses are unique. Let $n,m\in\Z$.
Suppose that $n+m = 0$. Show that $n=-m$ and $m=-n$.
\end{homework}

\begin{homework}
Show that $-0 = 0$.
\end{homework}

\begin{homework}
Show that for all integers $n$, $-(-n) = n$.
\end{homework}

\subsection{Axioms about multiplication}
The integers form a commutative ring under addition and multiplication.

\begin{enumerate}
\item $\times$ is associative: $\forall n,m,k\in\Z, (n\times m )\times k = n \times (m \times k)$
\item $\times$ is commutative: $\forall n,m\in\Z, n\times m = m\times n$
\item 1 is a multiplicative identity: $\forall n\not= 0, n\times 1 = n$
\item $\times$ distributes over $+$: $\forall n,m,k\in\Z, n\times(m+k) = (n\times m) + (n\times k)$
\end{enumerate}

\begin{remark}
Notice that in $\Z$ there are additive inverses but not multiplicative inverses.
\end{remark}

We use several other notations besides $\times$ to indicate multiplication.
All of the following can mean $a\times b: a*b, a\cdot b, ab$.
Multiplication has higher order of precedence than addition in an expression so
that $ab+cd$ means $(a\times b) + (c\times d)$ and not $a(b+c)d$.

\begin{homework}
Using any of the previous axioms, show that for all integers $n$, $n\times 0 = 0$.
(Hint: Use exercise \ref{ZeroIsUnique}.)
\end{homework}

\begin{lemma}
\label{OneIsUnique}
$1$ is the unique multiplicative identity.
\end{lemma}
\begin{proof}
Suppose $z$ is an integer with the property that for all non-zero integers $n$,
$zn = n$. We will show that $z=1$. Because both $z$ and 1 are multiplicative
identities we have $z\cdot 1 = 1$ and $z\cdot 1 = z$. So $z=1$.
\end{proof}

\begin{remark}
Compare Lemma \ref{OneIsUnique} to exercise \ref{ZeroIsUnique}. You might have expected
us to make the stronger claim that if $z$ and $w$ are any two integers and
$w\not=0$ and $zw = w$ then $z = 1$. This is of course true but we cannot prove
it based on just the axioms listed so far. The reason is that so far our axioms
only tell us that $\Z$ is a commutative ring, and there are some commutative rings
in which this stronger property is not true. We will get this stronger property
in Exercise \ref{StrongerOneIsUnique} below, but that will depend on first proving
Lemma \ref{ZIsAnIntegralDomain} which we cannot do without first adding more axioms.
\end{remark}

\begin{lemma}
For all $n$, $-n=-1\times n$.
\end{lemma}
\begin{proof}
Let $b=-1\times n$. Then $b+n = -1\times n + 1\times n = (-1 + 1)n = 0$.
Since $b+n=0$, $b=-n$.
\end{proof}

\begin{homework}
Prove that for all integers $a,b$, $(-a)b=a(-b)=-(ab)$.
\end{homework}

\subsection{Axioms of linear order}
$(\Z, <)$ is a discrete linear order in which $n+1$ is the successor of $n$ and
$n-1$ is the predecessor of $n$.

\begin{enumerate}
\item $<$ is transitive: $\forall n,m,p \in \Z, n < m \And m < p \implies n < p$
\item $<$ is asymmetric: $\forall n,m \in \Z, n < m \implies m \not< n$.
\item $<$ is connected: $\forall n,m \in \Z, n\not=m \implies (n < m \Or m < n)$
\item For all integers $n$, $n+1$ is the successor of $n$, i.e. the least integer greater than $n$.
That is, $n<n+1$ and there is no $m$ such that $n < m < n+1$.
\end{enumerate}

\begin{homework}
Using any of the previous axioms, show that for all integers
$n$, $n-1$ is the predecessor of $n$, i.e. the greatest integer
less than $n$.
\end{homework}

\begin{definition}
If $n>0$ we say that $n$ is positive and if $n<0$ we say that $n$ is negative.
\end{definition}


\begin{homework}
Use the axioms listed so far to show that 1 is the least positive integer.
\end{homework}

\subsection{Axiom of wellordering}
The set of positive integers is wellorderd by $<$ and the negative numbers are the
reflection of the positive numbers.

\begin{enumerate}
\item Every non-empty set of positive integers contains a least element.
\item If $n$ is negative then $-n$ is positive.
\end{enumerate}

Axiom (1) allows us to use proof by induction on the positive integers,
and axiom (2) assures us that there are no non-standard negative integers.
The only use we make of axiom (2) is in proving Lemma \ref{AddToInequality}
(which actually implies axiom (2)).
\begin{lemma}[Proof by induction] Let P be any property of integers. Suppose
\begin{enumerate}
\item[(i)] $P(1)$ holds, and
\item For all $n>0$, $P(n) \implies P(n+1)$.
\end{enumerate}
Then $P(n)$ holds for all positive integers.
\end{lemma}
\begin{proof}
Let $S$ be the set of positive integers for which $P$ does not hold. We will show that
$S$ is empty. Suppose $S$ is not empty and we will derive a contradiction.
By axiom (1), $S$ has a least element, $m$. By (i), $m\not=1$. Since
$m$ is positive and 1 is the least positive integer, $1 < m$, so $1 \leq m-1$,
so $m-1$ is positive. In other words, $m=n+1$ for some positive integer $n$.
Since $n<m$ and $m$ is the least positive integer in $S$,
$n\notin S$. So $P(n)$ holds. By (ii), $P(n+1)$ holds. So $m\notin S$. Contradiction.
\end{proof}

\begin{homework}
Show that the set of positive \emph{real} numbers is not wellordered by $<$.
Give a non-empty set of positive real numbers that does not contain a least element.
\end{homework}

Now that we have induction at our disposal, we will be able to prove more interesting
things about the integers. We prove a series of lemmas that relate addition and multiplication with the ordering $<$.

\begin{lemma}[Add to both sides of an inequality]
\label{AddToInequality}
Let $a,b,x$ be integers and suppose that $a<b$. Then $a+x < b+x$.
\end{lemma}
\begin{proof}
First we prove by induction that the lemma is true for positive $x$. For $x=1$
we need to prove that
$a<b\implies a+1 < b+1.$
This is true because, since $a<b$ and $a+1$ is the least integer greater than $a$,
$a+1\leq b < b+1$.

Now suppose the lemma is true for $x$ and we will show it is true for $x+1$.
We are assuming by induction that $a+x<b+x$ and we need to show that $a+x+1<b+x+1$.
But this follows from the argument we just gave.

Notice that the lemma is trivially true for $x=0$. So to finish the proof we need to prove that
the lemma is true for all negative $x$.

Suppose $x<0$ and the lemma is not true for $x$ so that $a<b$ but $b+x \leq a+x$.
We will derive a contradiction.
It cannot be true that $b+x=a+x$ because that would imply that $b=a$. So we must have
that $b+x < a+x$. Because $x<0$, axiom (2) says that $-x>0$ and so by the lemma for positive $x$, which
we have already proved, $b+x+(-x) < a+x+(-x)$, i.e. $b<a$. But this contradicts
the hypothesis that $a<b$, and so our proof is complete.
\end{proof}

\begin{homework}
Show that our axiom (2) in this section follows from Lemma \ref{AddToInequality}.
(Hint: Use the lemma with $b=0$.) (But we used axiom (2) in proving the lemma
so we cannot get rid of it.)
\end{homework}

We don't need to assume axiom (2) for positive numbers because we can prove it.

\begin{homework}
If $n$ is positive then $-n$ is negative.
(Hint: Use the previous lemma with $a=0$.)
\end{homework}

Axiom (2) of this section allows us to define \emph{absolute value.}

\begin{definition}
If $a$ is a non-negative integer then $\av{a} = a$. If $a$ is a negative integer
then $\av{a} = -a$.
\end{definition}

\begin{remark}
For all non-zero integers $a$, $\av{a} \geq 1$.
\end{remark}

\begin{homework}
For all integers $a,b$, $\av{ab} = \av{a}\av{b}$.
\end{homework}

\begin{lemma}
\label{OrderInTermsOfPositive}
For all integers $a,b$, $a<b$ iff $b-a$ is positive.
\end{lemma}
\begin{proof}
Adding $a$ to both sides of $0 < b-a$ yields $a<b$.
Adding $-a$ to both sides of $a<b$ yields $0 < b-a$.
\end{proof}

\begin{lemma}
\label{AddingPositiveIncreases}
For all integers $a,x$ with $x>0$, $a-x < a <a+x$.
\end{lemma}
\begin{proof}
The first inequality follows because $a-(a-x) = x$ is positive and
the second inequality follows because $a+x -a = x$ is positive.
\end{proof}

\begin{lemma}
\label{ProductOfTwoPositives}
If $a,b>0$ then $a \leq ab$.
\end{lemma}
\begin{proof}
By induction on $b$. For $b=1$ we have $a=a\cdot 1$. Now suppose the
lemma is true for $b$ and we will prove it is true for $b+1$.
We are assuming that $a\leq ab$. Then, since $a>0$, Lemma \ref{AddingPositiveIncreases}
tells us that $a \leq ab < ab+a = a(b+1)$.
\end{proof}

\begin{homework}
The product of two positive integers is positive.
\end{homework}

\begin{homework}
The product of a positive integer and a negative integer is negative.
The product of two negative integers is positive.
(Hint: Use the fact that $(-a)b = -(ab))$.
\end{homework}

\begin{lemma}[$\Z$ is an integral domain.]
\label{ZIsAnIntegralDomain}
If $n$ and $m$ are non-zero integers then $n\times m \not=0$.
\end{lemma}
\begin{proof}
This follows from the previous two exercises. If $n$ and $m$ are both
positive or both negative then their product is positive. Otherwise there
product is negative. In all cases their product is not zero.
\end{proof}

\begin{lemma}[Cancellation Law]
\label{CancellationLaw}
For all integers $a,b,c$, if $a\not=0$
and $ab = ac$ then $b=c$.
\end{lemma}
\begin{proof}
$ab=ac\IImplies ab-ac=0 \IImplies a(b-c) = 0$. Since $a\not=0$, Lemma
\ref{ZIsAnIntegralDomain} implies that $b-c=0$, so $b=c$.
\end{proof}

\begin{homework}
If $a<b$ and $x>0$ then $ax < bx$.
If $a<b$ and $x<0$ then $bx < ax$.
(Hint: Use Lemma \ref{OrderInTermsOfPositive}.)
\end{homework}

This exercise is a strengthening of Lemma \ref{OneIsUnique}. Compare the statement
to the statement of exercise \ref{ZeroIsUnique}.
\begin{homework}
\label{StrongerOneIsUnique}
For all integers $n$ and $m$, if $n\not=0$
and $n\times m=n$ then $m=1$.
\end{homework}

\textbf{Textbook Reading}
\emph{Preliminaries}, pages xiv-xvii of \emph{Shoup}.

\newpage

\section{Divisibility}

\begin{definition}
If $a$ and $b$ are integers we write $a\divides b$, pronounced $a$ \emph{divides}
$b$, iff there is an integer $c$ such that $b=ac$. If it is not true that
$a\divides b$ we write $a\nmid b$.

If $a\divides$ be we also say that $a$ is a \emph{divisor} of $b$ and that
$b$ is a \emph{multiple} of $a$ and that $b$ is \emph{divisible} by $a$.
\end{definition}

\begin{in_class_example}
Find all of the positive divisors of 12.
\end{in_class_example}


\begin{numbered_example}
Some examples of divisibility
\begin{itemize}
\item $3\divides 6$, $3\divides -6$, $-3\divides 6$, $-3\divides -6$.
\item $3 \ndivides 8$, $6\ndivides 3$.
\item For all integers $b$, $1\divides b$ because $b = 1\cdot b$.
\item For all integers $a$, $a\divides a$ because $a = a\cdot 1$.
\item For all integers $a$, $a\divides 0$ because $0 = a\cdot 0$.
\item In particular $0\divides 0$.
\item If $b\not=0$ then $0\ndivides b$ because for all $c$, $b\not=0\cdot c$.
\end{itemize}

\end{numbered_example}

\begin{lemma}
If $a\divides b$ and $b\not=0$ then $1 \leq \av{a} \leq \av{b}$.
\end{lemma}
\begin{proof}
Suppose $b=ac$ and $b\not=0$. Then $c\not=0$, so $\av{c}\geq 1$, and
$\av{b} = \av{ac} = \av{a}\av{c}$. So $\av{b} \geq \av{a}$ by Lemma
\ref{ProductOfTwoPositives}.
\end{proof}

\begin{homework}
Prove the following. For all integers $a,b,c$
\begin{itemize}
\item $a\divides b$ iff $-a\divides b$ iff $a\divides -b$.
\item $a\divides b \And a\divides c \IImplies a\divides (b+c)$.
\item $a\divides b \And b\divides c \IImplies  a\divides c$.
\end{itemize}
\end{homework}

\begin{definition}
Let $a$ be a nonzero element of a commutative ring. Then $a$ is called a
\emph{zero-divisors} iff there is a nonzero element $b$ such that $ab=0$.
\end{definition}

There are no zero-divisors in $\Z$. But other rings we will consider in this
class do have zero-divisors.

\begin{definition}
An integer $a$ is called a \emph{unit} iff $a\divides 1$.
\end{definition}

\begin{lemma}
$a$ is a unit iff $a$ has a multiplicative inverse.
\end{lemma}
\begin{proof}
$a\divides 1$ iff there is a $c$ such that $ac=1$. This $c$ is a multiplicative
inverse of $a$ by definition.
\end{proof}

\begin{lemma}
If $u$ is a unit and $a=bu$ then there is a unit $t$ such that $b=at$.
\end{lemma}
\begin{proof}
Since $u$ is a unit there is a $t$ such that $ut=1$. Multiply both sides
of $a=bu$ by $t$ to get $at=but=b$.
\end{proof}

\begin{definition}
Two integers $a$ and $b$ are called \emph{associates} iff there
is a unit $u$ such that $a=bu$, or equivalently there is a unit $t$ such
that $b=at$.
\end{definition}

\begin{lemma}
Let $a$ and $b$ be integers. Then $a$ and $b$ are associates iff $a\divides b$
and $b\divides a$.
\end{lemma}
\begin{proof}
If $a$ and $b$ are associates then there are units $u$ and $t$ such that
$a=bu$ and $b=at$. Therefore $a\divides b$ and $b\divides a$.

Conversely, suppose $a\divides b$ and $b\divides a$. Let $c$ and $d$ be such
that $a=bc$ and $b=ad$. Then $a=adc$. By the Cancellation Law Lemma
\ref{CancellationLaw} $1=dc$. This means that $d$ and $c$ are units and so
$a$ and $b$ are associates.
\end{proof}

\begin{lemma}
The units of $\Z$ are 1 and -1.

Therefore in $\Z$, $a$ and $b$ are associates iff $a=\pm b$.

Also $a\divides b$ and $b\divides a$ iff $a=\pm b$.
\end{lemma}
\begin{proof}
Suppose $a\divides 1$ so there is a $b$ such that $1=ab$.
Then $a,b\not=0$ so $\av{a}\geq 1$, $\av{b}\geq 1$.
We have $1=\av{1} = \av{a}\av{b} \geq \av{a} \geq 1$. So $\av{a} = 1$
so $a=1$ or $a=-1$.
\end{proof}

\begin{theorem}[Quotient and Remainder Property. a.k.a. Euclid's Division Lemma]
Let $a,b$ be integers with $b>0$. Then there are unique
integers $q,r$ with $0\leq r < b$
such that $a = qb+r$.

$q$ is called the \emph{quotient} and $r$ is called the remainder.
\end{theorem}
\begin{proof}
Let $S=\setof{a-qb}{q\in\Z\And a-qb\geq 0}$.

\begin{claim}[Claim 1]
$S\not=\emptyset$.
\end{claim}

\begin{subproof}[Proof of Claim 1]
If $a\geq 0$ then let $q=0$. Then $a=a-qb\geq0$ so $a-qb\in S$.
If $a<0$, let $q=a$. Then $a-qb=a-ab=a(1-b)$. Since $a<0$ and $1-b\leq 0$,
$a-qb\geq 0$ so $a-qb\in S$. In either case we have found an element of $S$
so $S\not=\emptyset$.
\end{subproof}

Since $S$ is a non-empty set of non-negative integers, let $r$ be the smallest element of $S$,
and let $q$ be such that $r=a-qb$. Then $a=qb+r$ and $r\geq 0$.

\begin{claim}[Claim 2]
$r<b$.
\end{claim}

\begin{subproof}[Proof of Claim 2]
Suppose $r\geq b$ and let $\rprime = r -b$. Then $0\leq\rprime < r$ and
$\rprime = r - b = a-qb -b = a -(q+1) b \in S$. This contradicts the fact that
$r$ was chosen to be the smallest element of $S$.
\end{subproof}

So we have shown that there are integers $q,r$ with $0\leq r < b$
such that $a = qb+r$. What's left is to show that these are the unique such integers.

Suppose there were another pair of integers $\qprime$ and $\rprime$ such that
$0\leq \rprime < b$ and $a = \qprime b+\rprime$. Then
$qb+r = \qprime b + \rprime$ so $(q - \qprime)b = \rprime-r$. We claim
that $q=\qprime$ and $r=\rprime$. If not then  $q-\qprime\not=0$ and
$r-\rprime\not=0$.  Assume $q>\qprime$ (or else swap the names of $q$ and $\qprime$.)
Then $q-\qprime > 0$ and $b>0$ and $r\geq 0$ so
$\rprime \geq \rprime-r = (q - \qprime)b \geq b$.
This contradicts the fact that $\rprime < b$, so $q=\qprime$ and $r=\rprime$.
\end{proof}

In definition \ref{ModOperatorTake1} we defined the $\bmod$ operator on positive
numbers $a$ and $b$. Now we give a slightly more general definition where we
don't require $a$ to be positive.

\begin{definition}[The $\bmod$ operator]
\label{ModOperator}
Let $a$ be any integer and $b$ a positive integer. Let $q$ and $r$
be the unique quotient and remainder from the previous theorem so that
$a=qb+r$ with $0\leq r < b$.Then we define
$a \bmod b=r$.
\end{definition}

\begin{homework} Compute the following remainders.
\begin{itemize}
\item $17 \bmod 100$
\item $100 \bmod 17$
\item $-17 \bmod 100$
\item $-100 \bmod 17$
\item $27 \bmod 3$
\item $4 \bmod 3$
\item $3 \bmod 3$
\item $2 \bmod 3$
\item $1 \bmod 3$
\item $0 \bmod 3$
\item $-1 \bmod 3$
\item $-2 \bmod 3$
\item $-3 \bmod 3$
\item $-4 \bmod 3$
\end{itemize}
\end{homework}

\textbf{Textbook Reading} Read Section 1.1
\emph{Divisibility and primality}, pages 1 -4 of \emph{Shoup}.

\textbf{Textbook Exercises:} Do exercise 1.1 on page 4 of \emph{Shoup}.

\newpage

\section{Ideals and GCDs}

The $\gcd$ or greatest common divisor of two integers is an easy concept.
$\gcd(a,b)$ is the greatest integer that divides both $a$ and $b$.
For example $\gcd(12,18) = 6$. This is because the positive divisors of 12 are
1,2,3,4,6,12 and the positive divisors of 18 are 1,2,3,6, 9, 18. The common
positive divisors of 12 and 18 are 1,2,3,6 and the greatest of these is 6.
We will eventually get back to this simple understanding of $\gcd$, but it will
pay to start with a more abstract and sophisticated definition of $\gcd$
based on the concept of an ideal.

\begin{definition}
If $a_1,a_2,\cdots, a_n$ are some fixed set of integers,
then an \emph{integer linear combination}
of $a_1,a_2,\cdots a_n$ is any value of the form
$$x_1 a_1 + x_2 a_2 + \cdots + x_n a_n $$
where the $x_i$ are any integers. In this context the $x_i$ are called
\emph{scalars} and they are also called the \emph{coefficients} of the
linear combination.
\end{definition}

Later we will see that we can make sense of integer linear combinations
where the $a_1,a_2,\cdots, a_n$ are objects other than integers. The thing that
makes this an \emph{integer} linear combination is that the \emph{coefficients}
are integers, not that the $a_i$ are integers.

\begin{definition}
An \emph{ideal} of $\Z$ is a non-empty set $I\subset\Z$ such that
\begin{enumerate}
\item $I$ is closed under addition: If $a,b\in I$ then $a+b\in I$.
\item $I$ is closed under scalar multiplication:
If $a\in I$ then for all integers $x$, $xa\in I$.
\end{enumerate}
\end{definition}

\begin{lemma}
Let $I$ be an ideal of $\Z$. Then $0\in I$ and $I$ is closed under subtraction
and integer linear combinations.
\end{lemma}
\begin{proof}
By definition, $I$ is not empty so let $a\in I$. Then $0=0\cdot a \in I$.

Let $a,b\in I$. Then $-1\cdot b = -b \in I$ so $a + (-b) = a-b\in I$.

Suppose $a_1,a_2,\cdots,a_n\in I$ and let
$b=x_1 a_1 + x_2 a_2 + \cdots + x_n a_n$ be any integer linear combination of
the $a_1,a_2,\cdots,a_n$. Then by repeatedly applying closure under addition
and scalar multiplication we can see that $b\in I$. Formally we can arrange this
 as a proof by induction on $n$. For $n=1$, $x_1 a_1 \in I$ by closure under
 scalar multiplication. Now suppose
 $b= x_1 a_1 + x_2 a_2 + \cdots + x_n a_n \in I$ and
 we sill show that $c = x_1 a_1 + x_2 a_2 + \cdots + x_n a_n + x_{n+1}a_{n+1} \in I$.
 $x_{n+1}a_{n+1} \in I$ by closure under scalar multiplication and so
 $c=b+x_{n+1}a_{n+1} \in I$ by closure under addition.
\end{proof}

\begin{lemma}
Let $I$ be an ideal of $\Z$. Then $I=\Z$ iff $1\in I$.
\end{lemma}
\begin{proof}
If $I=\Z$ then of course $1\in I$. Conversely suppose $1\in I$. Then for
all $z\in\Z$, $z=1\cdot z \in I$.
\end{proof}

\begin{homework}
Suppose $I_1$ and $I_2$ are ideals. Show that $I_1\intersect I_2$ is an ideal.

Now suppose that $\cS$ is a non-empty collection of ideals. Prove that the intersection
of all ideals in $\cS$ is also an ideal.
\end{homework}

\begin{definition}
Let $a$ be an integer. Then the \emph{principal ideal generated by $a$},
written $(a)$, is defined as the smallest ideal of $\Z$ containing the element $a$.
(To see that there \emph{is} a smallest ideal containing $a$, consider the
intersection of all ideals containing $a$ and notice that by the previous
exercise, that is an ideal.)
\end{definition}

\begin{definition}
Let $a$ be an integer. Then $a\Z$ is the set of all integer multiples of $a$.
\end{definition}

\begin{homework}
Show that $a\Z$ is an ideal of $\Z$ that contains $a$.
\end{homework}

\begin{lemma}
Let $a$ be an integer. Then $(a)=a\Z$.
\end{lemma}
\begin{proof}
Since $(a)$ is closed under
scalar multiplication and $a\in (a)$, $a\Z\subseteq (a)$. On the other hand,
$(a)$ is the smallest ideal containing $a$ and $a\Z$ is an ideal containing
$a$ so $(a)\subseteq a\Z$.
\end{proof}

\begin{in_class_example}
\quad
\begin{itemize}
\item Letting $a=0$ we have $(0)=\singleton{0}$.
\item Letting $a=1$ we have $(1) = \Z$.
\item Letting $a=2$ we have $(2)$ is the set of all even numbers.
\end{itemize}
\end{in_class_example}

\begin{homework}
\quad
\begin{itemize}
\item $b\in (a)$ iff $a\divides b$.
\item For any ideal $I$, $b\in I$ iff $(b) \subseteq I$.
\item $(b)\subseteq (a)$ iff $a \divides b$.
\end{itemize}
\end{homework}

\begin{definition}
Let $I_1$ and $I_2$ be ideals. Then $I_1+I_2$ is defined by
$$I_1+I_2 = \setof{a_1+a_2}{a_1\in I_1\And a_2 \in I_2}.$$
\end{definition}

\begin{homework}
Show that $I_1 + I_2$ is an ideal.
\end{homework}

\begin{homework}
Let $(a)$ and $(b)$ be two principal ideals.
Show that $(a)+(b)$ is equal to the set of
all integer linear combinations of $a$ and $b$.
\end{homework}

\begin{definition}
If $a$ and $b$ are two integers, then $(a,b)$ is defined to be the smallest
ideal containing $a$ and $b$. (To see that there \emph{is} a smallest
ideal containing $a$ and $b$, consider the intersection of all ideals containing
$a$ and $b$ and notice that, by an earlier exercise, that is itself an ideal.)
\end{definition}

\begin{homework}
Show that $(a,b) = (a) + (b)$.
\end{homework}

\begin{in_class_example}
\quad
\begin{itemize}
\item $(3) + (5) = (3,5) = (1) = \Z$.

\item $(4) + (6) = (4,6) = (2)$ = the set of all even numbers.

\item $(12) + (18) = (12,18) = (6)$ = the set of all multiples of 6.
\end{itemize}
\end{in_class_example}

\begin{theorem}[$\Z$ is a PID]
\label{ZIsAPID}
Let $I$ be an ideal of $\Z$. Then there exists a unique non-negative integer
 $d$
such that $I=(d)$.
Therefore every ideal of $\Z$ is principle. We say that $\Z$ is a principal ideal domain,
or PID.
\end{theorem}
\begin{proof}
Let $I$ be an ideal of $\Z$. If $I=\singleton{0}$ then $I=(0)$ and so $I$ is
principal.

Otherwise
there is a non-zero element of $I$ and by multiplying by $-1$ if necessary
we have that there is a positive element of $I$. Let $d$ be the least positive
element of $I$. We claim that $I=(d)$. Since $d\in I$, $(d)\subseteq I$.
So we need to show that $I\subseteq (d)$. Let $a\in I$. To show that $a\in (d)$
we need to show that $d\divides a$. Let $q$ and $r$ be such that
$a=qd+r$ with $0\leq r < d$. Since $a\in I$ and $d\in I$, we have that
$qd\in I$ and $r=a-qd\in I$. But $0\leq r<d$ and $d$ is the least positive element
of $I$, so $r=0$. This means that $d \divides a$ so $a\in (d)$.

We have shown that $I=(d)$. Now we need to show that $d$ is the unique
non-negative integer with this property. Suppose
that $(e) = (d)$ and $e$ is also non-negative. Since
$e\in (d)$, $d\divides e$. Since $d\in (e)$, $e\divides d$.
Thus $e = \pm d$. But $d$ and $e$ are both non-negative. So
$e=d$.
\end{proof}

\begin{definition}[GCD]
Let $a$ and $b$ be integers. Then the \emph{greatest common divisor} of
$a$ and $b$, written $\gcd(a,b)$, is the unique non-negative integer $d$
such that $(d) = (a,b)$.
\end{definition}

\begin{in_class_example}
\quad
\begin{itemize}
\item Above we saw that $(3,5) = (1)$, so $\gcd(3,5) = 1$.

\item Above bove we saw that $(4,6) = (2)$, so $\gcd(4,6) = 2$.
\end{itemize}
\end{in_class_example}

\begin{definition}
Let $a$ and $b$ be integers. Then $d$ is a \emph{common divisor} of $a$ and $b$
iff $d\divides a$ and $d\divides b$.
\end{definition}

\begin{lemma}
$\gcd(a,b)$ is the unique non-negative
integer $d$ such that
\begin{itemize}
\item $d$ is a common divisor of $a$ and $b$ and
\item if $c$ is any common divisor of $a$ and $b$ then $c\divides d$.
\end{itemize}
\end{lemma}
\begin{proof}
To say that $e$ is a common divisor of $a$ and $b$ is the same as to say that
$a\in (e)$ and $b\in (e)$ which is the same as to say that

\begin{equation}
\label{gcd-equation-1}
(a,b) \subseteq (e).
\end{equation}

To say that every common divisor of $a$ and $b$ also divides $e$ is the same
as to say that $(a,b) \subseteq (c) \implies e \in (c)$ which is to say

\begin{equation}
\label{gcd-equation-2}
(a,b) \subseteq (c) \implies (e) \subseteq (c).
\end{equation}


Both of these are true true for $e=\gcd(a,b)$ because for that $e$ we have
$(a,b) = (e)$.

To show uniqueness, suppose $d=\gcd(a,b)$ and $e$ is any integer satisfying
equations (\ref{gcd-equation-1}) and (\ref{gcd-equation-2}).

Then $(d) = (a,b) \subseteq (e)$ by (\ref{gcd-equation-1}) and,
since $(a,b) \subseteq (d)$,
$(e) \subseteq (d)$ by (\ref{gcd-equation-2}).
So $(d) = (e)$ and since $d$ and $e$ are both non-negative, by
Theorem \ref{ZIsAPID}, $d=e$.
\end{proof}

\begin{in_class_example}
\quad
\begin{itemize}
\item $\gcd(3,5)=1$. Suppose $a\divides 3$ and $a\divides 5$. Then $a\divides 1$.

\item $\gcd(4,6)=2$. Suppose $a\divides 4$ and $a\divides 6$. Then $a\divides 2$.

\item $\gcd(12,18)=6$. Suppose $a\divides 12$ and $a\divides 18$. Then $a\divides 6$.
\end{itemize}
\end{in_class_example}

\begin{lemma}
$\gcd(a,b)$ is the greatest common divisor of $a$ and $b$.
\end{lemma}
\begin{proof}
Let $d=\gcd(a,b)$. We have already seen that $d$ is a common divisor of
$a$ and $b$. Suppose $c$ is any other common divisor. We need to see that
$c\leq d$. By the previous
lemma, $c\divides{d}$. Thus $c\leq\av{c}\leq\av{d}=d$.
\end{proof}

The main advantage of our abstract approach to $\gcd$s via ideals is that
now we know the following:

\begin{theorem}
Let $a$, $b$ be integers. Then $\gcd(a,b)$ can be expressed as an integer
linear combination of $a$ and $b$.
\end{theorem}
\begin{proof}
Let $d=\gcd(a,b)$. The theorem follows immediately from the fact that
$(d) = (a,b)$.
\end{proof}

\begin{in_class_example}
Express $\gcd(6,10)$ as a linear combination of $6$ and $10$.
\end{in_class_example}

\begin{homework}
In each case below, express $gcd(a,b)$ as a linear combination of $a$ and $b$.
\begin{enumerate}
\item $a = 8, b= 12$
\item $a = 20, b= 12$
\item $a=10, b=7$
\item $a=20, b=14$
\end{enumerate}
\end{homework}

\begin{definition}
Two integers $a$ and $b$ are called \emph{relatively prime} if
$\gcd(a,b) = 1$.
\end{definition}

\begin{lemma}
Let $a$, $b$ be integers. Then $a$, $b$ are relatively prime iff
their only positive common divisor is $1$.
\end{lemma}
\begin{proof} $a$ and $b$ are relatively prime iff
$\gcd(a,b)=1$ iff all common divisors of $a$ and $b$ divide 1
iff the only positive common divisor is 1.
\end{proof}

\begin{in_class_example}
$\gcd(6,25) = 1$ so $6$ and $25$ are relatively prime.
\end{in_class_example}

\begin{theorem}
Let $a$, $b$ be integers. Then $a$ and $b$ are relatively prime iff
there is an integer linear combination of $a$ and $b$ that equals 1.
\end{theorem}
\begin{proof}
We already saw that $\gcd(a,b)$ can be expressed as a linear combination
of $a$ and $b$ so if $1=\gcd(a,b)$ then 1 can be expressed as a linear combination
of $a$ and $b$.

Conversely, suppose 1 can be expressed as a linear combination of $a$ and $b$.
This means that $1\in (a,b)$ so $(a,b) = \Z = (1)$ so $1=\gcd(a,b)$.
\end{proof}

\begin{in_class_example}
$\gcd(6,25) = 1$. Find an integer linear combination of $6$ and $25$
that equals 1.
\end{in_class_example}

This last idea is the key ingredient we will need in the next section to
prove the Fundamental Theorem of Arithmetic.

\begin{in_class_example}
True or false? If $c \divides ab$ then $c\divides a$ or $c \divides b$.
Consider this question with two examples:
\begin{itemize}
\item $a = 9,  b = 50, c = 10$
\item $a = 9,  b = 50, c = 15$
\end{itemize}
\end{in_class_example}

\begin{theorem}
\label{PrePrimeProperty}
Let $a,b,c \in \Z$ such that $c\divides ab$ and $\gcd(c,a) = 1$.
Then $c \divides b$.
\end{theorem}
\begin{proof}
Since $\gcd(c,a) = 1$ there are integers $x$ and $y$ such that
$xc + ya = 1$. Multiply both sides of this equation by $b$ to
get $xcb + yab = b$.  Now $c\divides xcb$ and by hypothesis
$c\divides ab$. So $c\divides b$.
\end{proof}

\bigskip

\textbf{Textbook Reading} Read Section 1.2
\emph{Ideals and greatest common divisors}, pages 5-8 of \emph{Shoup}.

\bigskip

\textbf{Textbook Exercises:} Do the following exercises on page 9 of
\emph{Shoup}: 1.8, 1.9, 1.10, 1.11

\newpage

\section{Primes}

A \emph{prime number} is an integer $p>1$ such that the only positive divisors
of $p$ are $1$ and $p$. The first few prime numbers are $2,3,5,7,11,13,17,19,23$.

If $n>1$ is not prime it is called \emph{composite}.

Notice that $1$ is not considered either prime or composite.

Also we will only use the terms prime and composite for positive numbers.

Notice that $n$ is composite iff  $n=ab$ for some integers $a$ and $b$ with
$1<a,b<n$.

Let $p$ be prime and let $a$ be any integer. What are the possibilities
for $\gcd(p,a)$?

\begin{homework}
Let $p$ be prime and let $a$ be any integer. Then either
\begin{itemize}
  \item $p\divides a$ and $\gcd(p,a) = p$, or
  \item $p\ndivides a$ and $\gcd(p,a) = 1$.
\end{itemize}
\end{homework}

\begin{theorem} Let $p$ be prime and let $a,b\in\Z$.
\label{PrimeProperty}
If $p\divides ab$ then $p\divides a$ or $p\divides b$.
\end{theorem}
\begin{proof}
Suppose $p\divides ab$ and $p\ndivides a$. Then $\gcd(p,a) = 1$.
By Theorem \ref{PrePrimeProperty} $p\divides b$.
\end{proof}

\begin{definition}
\label{PrimePropertyDef}
Let $x>1$ be an integer. We say that $x$ has the \emph{prime property}
iff for all $a,b\in\Z$, if $x\divides ab$ then $x\divides a$ or $x\divides b$.
\end{definition}

The previous theorem says that primes have the prime property.

\begin{theorem}
\label{PrimesAreIrreducible}
Let $x>1$ be an integer with the prime property. Then $x$ is prime.
\end{theorem}
\begin{proof}
Suppose $x$ is not prime. Then $x=ab$ with $1<a,b<x$. But then $x\divides ab$
and $x\ndivides a$ and $x\ndivides b$ so $x$ does not have the prime property.
\end{proof}

So for positive integers, having the prime property is equivalent to being
prime. In fact in an arbitrary commutative ring, the prime property is
used as the definition of prime and our definition of prime is what in an
arbitrary integral domain is called \emph{irreducible}.

More precisely, in a commutative ring $R$, an element $x\in R$ is called
\emph{prime} iff $x\not=0$ and $x$ is not a unit and for all $a,b\in R$, if $x\divides ab$ then
$x\divides a$ or $x\divides b$.

In an integral domain $R$, an element $x\in R$ is called \emph{irreducible}
iff $x\not=0$ and $x$ is not a unit and whenever $x = ab$ then either $a$ or $b$ is a unit.

In an arbitrary integral domain, all primes are irreducible. A proof similar to
our proof of Theorem \ref{PrimesAreIrreducible} works. But it is not necessarily
true that every prime is irreducible. This is because
for the proof of Theorem \ref{PrimeProperty} we needed to use GCDs and not
every integral domain has GCDs.

\begin{corollary}
\label{GeneralizedPrimeProperty}
Let $p$ be prime and let $a_1,\cdots,a_k\in\Z$. If $p$ divides the product
$a_1\cdots a_k$ then $p$ divides one of the $a_i$.
\end{corollary}
\begin{proof}
By induction on $k$. For $k=1$ there is nothing to prove and $k=2$ is
Theorem \ref{PrimeProperty}. Suppose the corollary is true for $k$ and
we will show it is true for $k+1$. Suppose $p$ divides $a_1\cdots a_k a_{k+1}$.
Let $b=a_1\cdots a_k$. Then $p\divides b a_{k+1}$. By the case $k=2$,
$p\divides b$ or $p\divides a_{k+1}$. If $p\divides a_{k+1}$ we are done,
so suppose $p\divides b$. Then $p$ divides the product $a_1\cdots a_k$, so
by induction, $p$ divides one of the $a_i$.
\end{proof}

\begin{theorem}[Fundamental theorem of arithmetic]
Every non-zero integer $n$ can be expressed as
$$n=\pm p_1^{e_1} \cdots p_r^{e_r}$$
where $p_1,\cdots,p_r$ are distinct primes and $e_1,\cdots,e_r$ are positive integers.
Moreover this expression is unique up to a reordering of the primes.
\end{theorem}

If $n=\pm 1$ then $r=0$ and the empty product is interpreted as 1.

\begin{proof}
 First, it suffices to prove the theorem for $n > 0$ because then
if $n < 0$ then the unique prime factorization of $n$ is just $-1$ times the
unique prime factorization of $-n$. So assume that $n > 0$.
First we will prove existence and then we will prove uniqueness.

We prove existence by induction on $n$. For $n = 1$, we have that 1
has a prime factorization given by the empty product.

Now assume $n > 1$ and that for all positive $m < n$, $m$ has a prime
factorization. If $n$ is prime then $n$ is already a prime factorization.
So suppose $n$ is composite. Then there exists $a, b$ with $1 < a, b < n$
such that $n = ab$. By induction, $a$ and $b$ have a prime factorization, so
$n = ab$ does.

That completes the proof of existence of prime factorizations. Now
we turn to uniqueness.


Suppose $p_1 p_2 \cdots p_r = q_1 q_2 \cdots q_r$ where each $p_i$ and each $q_j$ are 
prime.
But we are no longer assuming that the $p_i$ are distinct. That is, $p_1$
might equal $p_2$. That is what allows us to not write the exponents $e_i$
from the statement of the theorem.

We want to prove that the $p_i$ are a rearrangement of the $q_j$.
In other
words, we want to prove that $r = s$ and that the $p_i$ and the $q_j$ are the
same, except possibly in a different order.


We prove this fact by induction on $r$. If $r = 0$ then the left-hand-side
equals 1 so the right hand side equals 1 so $s = 0$ and we are done. So
now suppose that $r > 0$. So then we must also have $s > 0$.

Assume the uniqueness claim is true for $r - 1$ and we will show it
is true for $r$. Since $p_1$ divides the left-hand-side, $p_1$ divides the 
righthand-side. In other words

$$p_1 \divides q_1 q_2 \cdots q_s.$$

Because $p_1$ is prime, by Corollary \ref{GeneralizedPrimeProperty},
$p_1$ divides one of the $q_j$.
But $q_j$
is prime so its only positive divisors are $q_j$ and 1, so we must have
that $p_1=q_j$.
This allows us to cancel $p_1$ from the left-hand-side and $q_j$
from the right-hand-side and get 
$p_1\cdots p_r = q_1 \cdots q_{j-i} \cdot q_{j+1} \cdots q_s$. By
induction, $r - 1 = s - 1$ and the remaining $p_i$ are a rearrangement of
the remaining $q_k$. Therefore the original $p_i$ are a rearrangement of the
original $q_j$.
\end{proof}


\textbf{Textbook Exercises:} Do exercise 1.2 on page 4 of Shoup. Do
exercises 1.12 and 1.15 on page 9 of Shoup.

\newpage

\section{Consequences of Unique Factorization}

\begin{theorem}
There are infinitely many primes.
\end{theorem}
\begin{proof}
Suppose towards a contradiction that there were finitely many primes,
$p_1,p_2,\cdots,p_n$. Let $a$ be the product of all of these primes:
$$a=p_1 p_2 \cdots p_n$$

Consider the number $a+1$. Since $a+1$ is greater than each of the $p_i$, it is not
one of the $p_i$, so it is not prime, so it is composite. Since it is composite
it is divisible by a prime and so there is some $i$ such that $p_i \divides (a+1)$.

But also $p_i \divides a$ so then $p_i \divides 1$ which is impossible.

This contradiction implies that there were not finitely many primes.
\end{proof}

\begin{definition}
Let $p$ be a prime and $n$ a non-zero integer. Then $\nu_p(n)$ is the greatest
non-negative integer $\nu$ such that $p^{\nu}\divides n$. 

In other words,
Let $n = p_1^{e_1} \cdots p_r^{e_r}$ be the unique prime factorization of $n$ with each
fo the $p_i$ distinct. If $p$ is not one of the $p_i$ then $p\ndivides n$ and
$\nu_p(n) = 0$. Otherwise, $p\divides n$ and $p=p_i$ for some $i$. In this case
$\nu_p(n) = e_i$.
\end{definition}

With this definition, each non-zero integer $n$ can be represented as

$$n = \pm \prod_p p^{\nu_p(n)}$$

where the product is over all primes $p$.For all but finitely many primes $p$,
$\nu_p(n)=0$.

\begin{in_class_example}
Examples of this expression for some $n$.
\end{in_class_example}

\begin{numbered_fact}
$\nu_p(a\cdot b) = \nu_p(a) + \nu_p(b)$
\end{numbered_fact}

\begin{in_class_example}
Examples of this fact.
\end{in_class_example}

\begin{numbered_fact}
$a\divides b$ iff $\nu_p(a) \leq \nu_p(b)$ for all primes $p$.
\end{numbered_fact}

\begin{in_class_example}
Examples of this fact.
\end{in_class_example}

\begin{numbered_fact}
$$\gcd(a,b)=\prod_p p^{\min(\nu_p(a), \nu_p(b))}$$
\end{numbered_fact}

\begin{in_class_example}
Examples of this fact.
\end{in_class_example}

\begin{homework} Find
\begin{enumerate}
\item[(a)] $\nu_5(100)$
\item[(b)] $\nu_5(-100)$
\item[(c)] the smallest positive integers $a,b,c$ such that $\nu_2(a)=b$ and 
$\nu_3(b)=c$ and $\nu_2(c) > \nu_3(c)$.
\end{enumerate}
\end{homework}

\begin{definition}
Let $a,b\in\Z$. Then a \emph{common multiple} of $a$ and $b$ is an integer $m$
that is a multiple of both $a$ and $b$. 
\end{definition}

Notice that 0 is a common multiple of every pair $a,b$.

Let $a,b$ be two non-zero integers. Then they have at least one positive common multiple,
namely $\av{a} \av{b}$.

\begin{definition}
Let $a,b\in \Z$. Then the \textbf{least common multiple} of $a$ and $b$,
$\lcm(a,b)$ is the least non-negative common multiple of $a$ and $b$.
\end{definition}

\begin{in_class_example}
Examples of $\lcm$s.
\end{in_class_example}

\begin{numbered_fact}
$$\lcm(a,b) =\prod_p p^{\max(\nu_p(a), \nu_p(b))}$$
\end{numbered_fact}

\begin{numbered_fact}
$\lcm(a,b)$ divides every common multiple of $a$ and $b$.
\end{numbered_fact}

\begin{in_class_example}
Examples of these facts.
\end{in_class_example}

\begin{fact}
$\lcm(a,b)$ is the unique non-negative integer $m$ such that $(m) = (a) \intersect (b)$.
\end{fact}
You will prove this fact for homework.

\begin{fact}
$\gcd(a,b) \cdot \lcm(a,b) = \av{a,b}$.
\end{fact}
You will prove this fact for homework.

\begin{fact}
Let $a$ and $b$ be positive integers. Then
$\lcm(a,b) = ab$ iff $a$ and $b$ are relatively prime.
\end{fact}
You will prove this fact for homework.

\textbf{Textbook Reading} Read Section 1.3 of Shoup.

\textbf{Textbook Exercises:} Do exercise 1.20, 1.21, 1.27, 1.28, 1.29, 1.34
of \emph{Shoup}.

\newpage

\section{The Euclidean Algorithm}

Let $a,b\in\Z$ with $a>b>0$. Let $d=\gcd(a,b)$. We know that there are integers $x,y$ such that $d=xa+yb$.

\begin{question}
How do we find $d$?
\end{question}

\begin{question}
How do we find $x$ and $y$?
\end{question}



\textbf{Idea:} By the Quotient and Remainder Property (i.e. Euclid's Division Lemma) there are
unique $q,r\in\Z$ such that $a=qb+r$ with $0\leq r < b$. Notice that $r=a-qb$. This means that
$a$ is an integer linear combination of $b$ and $r$, and $r$ is an integer linear combination
of $a$ and $b$. This means that $(a,b) = (b,r)$. This means that $d=\gcd(a,b)=\gcd(b,r)$.

Why is this interesting? Because $b<a$ and $r<b$. We have reduced the problem of finding $\gcd(a,b)$
to the \emph{smaller} problem of finding $\gcd(b,r)$. The idea of the Euclidean algorithm is to
repeat this process yielding smaller and smaller pairs of integers until finally one of the integers is zero.

\begin{example}[The Euclidean Algorithm]
Find $\gcd(527,341)$.

$527 = 1 \cdot 341 + 186$. \qquad $\gcd(527,341) = \gcd(341,186)$.

$341 = 1 \cdot 186 + 155$. \qquad $\gcd(341, 186) = \gcd(186, 155)$.

$186 = 1 \cdot 155 +  31$. \qquad $\gcd(186, 155) = \gcd(155, 31)$.

$155 = 5 \cdot 31 + 0$. \qquad $\gcd(155, 31) = \gcd(31, 0) = 31$.

So $\gcd (527,341) = 31$.

To check this, find the prime factorization of 527 and 341.

$527 = 17 \cdot 31$.

$341 = 11 \cdot 31$.

So $\gcd(527, 341) = 31$.
\end{example}

What is the point of the Euclidean algorithm? We found the answer more easily by looking at the prime factorization? The point is that
the Euclidean algorithm is efficient. When dealing with large integers, finding the prime factorization is impossible.

Suppose $a$ and $b$ are each 100-digit integers. How long would it take to find the prime factorizations of $a$ and $b$?
There is no efficient algorithm for finding the prime factorization of large integers. The best algorithms for finding the prime factorization of $a$
are not much better than searching through every positive integer $n<a$, testing to see if $n$ is prime, and then testing to see if $n\divides a$.
How long would this take? Suppose it were possible to test 100-billion integers per second. (This is much faster than a computer could really do it.)
100-billion is $10^{11}$. We said that $a$ was 100 digits long, so approximately $10^{100}$. This means it would $\frac{10^{100}}{10^{11}} = 10^{89}$ seconds.
How long is that?
There are about 30 million seconds in a year. Let's round up to 100-million = $10^8$. So it would take more than $\frac{10^{89}}{10^{8}} = 10^{81}$ years.
Currently the universe is only about $10^{10}$ years old. So to find the prime factorization of $a$ would take much, much longer than the current age of the
universe. In other words, it is not possible even with all of the computers on earth churning away for a billion years.


Now compare this with the Euclidean Algorithm.

\begin{theorem}
The Euclidean algorithm runs in time proportional to the number of digits of $a$ times the number of digits of $b$
\end{theorem}
So if $a$ and $b$ were both 100-digits long it would take less than 10,000 steps to compute their $\gcd$. If we could do 1000 steps per second on a computer
(computers can do much better than this) it would take 10 seconds.

Why is this of practical importance? Why would we ever care about computing the $\gcd$ of two 100 digit integers? Number Theory has a very practical application: Cryptography,
the science of encryption. Computing the $\gcd$ and other number theoretic computations on large integers is an essential ingedient of the encryption that
your computer does every time you go to a URL that starts with ``https''. This is called public-key encryption and it is based on Number Theory computations on large integers.
We will learn about public-key encryption later in the course. For now it is important to understand only that some Number Theory computations are \emph{tractable} meaning
they can be performed in a reasonable amount of time because there exists an \emph{efficient} algorithm for them, while others are \emph{intractibale}, they cannot be
performed in a reasonable amount of time because there is no efficient algorithm for them. Computing the $\gcd$ of two 100-digit integers is tractable, finding the
prime factorization of a 100-digit integer is intractable.

Now back to the original problem. The Euclidean algorithm allows us to compute $d=\gcd(a,b)$. But how do we find $x,y$ such that $d=x\cdot a + y \cdot b$?.

Look back at the Euclidean algorithm computation above and notice that on each line we
expressed the remainder on that line as an integer linear combination of the
quotient and divisor from that line.
The $\gcd$ is the second-to-last remainder, and our goal is to express the $\gcd$
as an integer linear combination of of the original values $a$ and $b$. We can
do this by starting at the end of the computation and working backwards:


\bigskip

$31 = 186 - 155 \cdot 1$

$31 = 186 - (341 - 186 \cdot 1) = 2 \cdot 186 - 341$

$31 = 2 \cdot (527 - 341\cdot 1) - 341 = 2\cdot 527 - 3\cdot 341$.

\bigskip

Thus letting $x=2, y=-3$, we have that $31 = \gcd(527,341) = 527x + 341y$.
The technique we used to find $x$ and $y$ is called \emph{back-substitution}.

\bigskip

Next we are going to learn a technique that allows us to compute $x$ and $y$ at the same time that
we are computing $d$ and so allow us to avoid the extra back-substitution step.

\bigskip


\textbf{The Extended Euclidean Algorithm} Given $a,b\in\Z$ with $a>b>0$ define:

\begin{itemize}
\item $r_0=a$,  $s_0 = 1$, $t_0 = 0$
\item $r_1=b$, $s_1 = 0$, $t_1 = 1$
\item Motivation:
\item $a = qb + r \Implies r_0 = q_1 r_1 + r_2 \Implies r_2 = r_0 - q_1 r_1$.
\item In general for $i\geq 1$, let
\item $r_{i-1} = q_i r_i + r_{i+1}  \Implies r_{i+1} = r_{i-1} - q_i r_i$
\item $s_{i+1} = s_{i-1} - q_i s_i$
\item $t_{i+1} = t_{i-1} - q_i t_i$
\end{itemize}

The algorithm terminates when $r_{i+1}=0$. Then $r_i = d = \gcd(a,b)$ and $d = s_i a + t_i b$.

\bigskip

\begin{example} Let $a=527, b=341$. Use the extended Euclidean algorithm to find $d=\gcd(a,b)$ and $x$ and $y$ so
that $d=xa+yb$.
\end{example}

\bigskip


\begin{tabular}{|c|c|c|c|c|c|c|c|}
\hline
\quad & \quad                     & \quad       & \quad & 527    & 341   &  \quad                   & \quad \\ \hline
$i$   & \quad                     & $q_{i}$     & $r_i$ & $s_i$  & $t_i$ &  \quad                   & \quad \\ \hline\hline
0     & \quad                     & \quad       & 527   &  1     & 0     &  \quad                   & \quad \\ \hline
1     & \quad                     &  1          & 341   &  0     & 1     &  \quad                   & \quad \\ \hline
2     & $527 = 1\cdot 341 + 186$  &  1          & 186   &  1     & -1    & $s_2 = s_0 - q_1 s_1$    & $t_2 = t_0 - q_1 t_1$  \\
\quad & \quad                     & \quad       & \quad & \quad  & \quad & $1 =   1 - 1 \cdot 0$    & $-1=0-1\cdot1$ \\ \hline
3     & $341 = 1 \cdot 186 + 155$ &  1          & 155   &  -1    & 2     & $s_3 = s_1 - q_2 s_2$    & $t_3 = t_1 - q_2 t_2$  \\
\quad & \quad                     & \quad       & \quad & \quad  & \quad & $-1 =   0 - 1 \cdot 1$   & $2=1-1\cdot(-1)$ \\ \hline
4     & $186 = 1 \cdot 155 + 31$  &  1          & 31    &  2     & -3    & $s_4 = s_2 - q_3 s_3$    & $t_4 = t_1 - q_3 t_3$  \\
\quad & \quad                     & \quad       & \quad & \quad  & \quad & $2 =   1 - 1 \cdot (-1)$ & $-3=-1-1\cdot 2$ \\ \hline
5     & $155 = 5 \cdot 31 + 0$    &  5          & 0     & \quad  & \quad & \quad  &  \\ \hline
\end{tabular}

\bigskip

The algorithm terminated when $i=5$ because $r_5=0$. Thus $d=r_4=31$ and 
$d = s_4\cdot 527 + t_4 \cdot 341$.

\bigskip
$\gcd(527, 341) = 31$ and $31 = 2 \cdot 527 - 3 \cdot 341$.


\bigskip

\begin{example} Let $a=100, b=35$. Use the extended Euclidean algorithm to find $d=\gcd(a,b)$ and $x$ and $y$ so
that $d=xa+yb$.
\end{example}

\bigskip


\begin{tabular}{|c|c|c|c|c|c|c|c|}
\hline
\quad & \quad                     & \quad       & \quad & 100    &  35   &  \quad                   & \quad \\ \hline
$i$   & \quad                     & $q_{i}$     & $r_i$ & $s_i$  & $t_i$ &  \quad                   & \quad \\ \hline\hline
0     & \quad                     & \quad       & 100   &  1     & 0     &  \quad                   & \quad \\ \hline
1     & \quad                     &  2          &  35   &  0     & 1     &  \quad                   & \quad \\ \hline
2     & $100=2\cdot35 + 30$       &  1          &  30   &  1     & -2    & $s_2 = s_0 - q_1 s_1$    & $t_2 = t_0 - q_1 t_1$  \\
\quad & \quad                     & \quad       & \quad & \quad  & \quad & $1 =   1 - 2 \cdot 0$    & $-2=0-2\cdot1$ \\ \hline
3     &3$5 = 1\cdot 30 + 5$       &  6          &   5   &  -1    & 3     & $s_3 = s_1 - q_2 s_2$    & $t_3 = t_1 - q_2 t_2$  \\
\quad & \quad                     & \quad       & \quad & \quad  & \quad & $-1 =   0 - 1 \cdot 1$   & $3=1-1\cdot(-2)$ \\ \hline
4     & $30 = 6\cdot 5 + 0$       &             &   0   &        &       &                          &                \\ \hline
\end{tabular}

\bigskip

The algorithm terminated when $i=4$ because $r_4=0$. Thus $d=r_3=5$ and 
$d = s_3\cdot 100 + t_3 \cdot 35$.

\bigskip
$\gcd(100,35) = 5$ and $5 = -1 \cdot 100 + 3 \cdot 35$.

\bigskip

\textbf{Reading} Read the Wikipedia article on \emph{The Extended Euclidean Algorithm}.

\bigskip

\textbf{Textbook Reading} Read section 2-2 \emph{Divisibility} of \textbf{Number Theory} by George E. Andrews.

\bigskip

\textbf{Textbook Exercises:} From section 2-2 of Andrews do:
\begin{itemize}
\item \textbf{(1)} d,e,f
\item \textbf{(2)} But use the Extended Euclidean algorithm. Don't use back-substitution.
\item \textbf{(3)}
\item \textbf{(5)}
\end{itemize}

\bigskip

\textbf{Optional} Read sections 4.1 and 4.2 of Shoup. You will not be responsible for this. This is only if you are interested
in a more sophisticated computer science view of the Extended Euclidean algorithm.

\newpage

\section{Linear Diophantine Equations}

In the last example from the previous section we saw that 

$\gcd(100,35) = 5$ and $5 = -1 \cdot 100 + 3 \cdot 35$.

\begin{question}
Let $a=100, b=35, d=\gcd(a,b)=5$.


Are $x=-1$ and $y=3$ the only solutions to $x\cdot a + y\cdot b = d$?

\end{question}

Let $a,b,c\in\Z$ with $a,b\not=0$. Consider the following problem. Find all integers $x$ and $y$ such that
$$ax+by=c.$$

This is called a linear Diophantine equation.

We will see that a linear Diophantine equation has either no solutions or infinitely many solutions. Thus in
the particular case where $d=\gcd(a,b)$ there are infinitely many solutions to $ax+by=d$.


\begin{lemma}
Suppose $a$ and $b$ are relatively prime and $ax=by$.
Then there is a $k$ such that $x=k b$ and $y=ka$.
\end{lemma}
\begin{proof}
Since $a \divides by$ and $\gcd(a,b) = 1$, $a\divides y$, so there is some $k_1\in\Z$ such that
$y=k_1 a$. Similarly, there is some $k_2\in\Z$ such that $x=k_2 b$. Thus we have $ak_2 b = bk_1 a$
and so $k_1=k_2$. So $x = k_1 b$ and $y=k_1 a$.
\end{proof}

To start our investigation of linear Diophantine equations, let's first
consider the \emph{homogeneous} linear Diophantine equation
$$ax+by=0.$$


Let $d=\gcd(a,b)$.  Let $\abar$ and $\bbar$ be such that $a=d\abar$ and $b=d\bbar$.
Notice that $m=\abar \bbar d = \lcm(a,b)$.  Also note that $\abar$ and $\bbar$ are relatively prime. 

Note that $ax+by=0$ iff $ax=-by$ iff $\abar d x = - \bbar d y$ iff $\abar x = -\bbar y$.

Since $\gcd(\abar,\bbar)=1$, the previous lemma tells us that $\abar x = -\bbar y$ 
iff there is some $k\in\Z$ such that
$x=k\bbar,y=-k\abar$. So we have proven

\begin{lemma}
Let $a,b$ be non-zero integers. Let $d=\gcd(a,b)$ and let $\abar,\bbar$ be such that
$a=d\abar, b=d\bbar$. Then the set of solutions to the
homogeneous, linear Diophantine equation $ax+by=0$ is the set of $\angles{x,y}$ in the set
$$\setof{\angles{t\bbar,-t\abar}}{t\in\Z}.$$
\end{lemma}

Notice that the solutions to $ax+by=0$ are the points on the linear subspace of $\R^2$ spanned
by the vector $\angles{\bbar,-\abar}$ with integer coordinates.

\begin{in_class_example}
Find all solutions to the following homogeneous linear Diophantine equations:
\begin{itemize}
\item[(a)] $12x + 18y = 0$;
\item[(b)] $3x + 5y = 0$.
\end{itemize}
\end{in_class_example}


Now we go on to consider the general linear Diophantine equations $ax+by=c$.

As above, let $d=\gcd(a,b)$.  Let $\abar$ and $\bbar$ be such that $a=d\abar$ and $b=d\bbar$.
To repeat what we wrote above, notice that $m=\abar \bbar d = \lcm(a,b)$
and $\abar$ and $\bbar$ are relatively prime. 

Let $x_0$ and $y_0$ be such that $ax_0 + b y_0 = d$. We can find $x_0$ and $y_0$ using
the Extended Euclidean algorithm.

Now let $c\in \Z$. Notice that there is a solution to $ax+by=c$ iff $c$ can be written as a linear combination of $a$ and $b$
iff $c\in(a,b)$ iff $c\in(d)$ iff $d\divides c$. 



Suppose $d\divides c$ and let $c=d\cbar$. 


Then
$$ a (x_0 \cbar) +  b (y_0 \cbar)=  d \cbar = c.$$
Thus $x= x_0 \cbar, y=y_0 \cbar $ is a \emph{particular} solution to the linear Diophantine equation $ax+by=c$.



We want to understand the \emph{general} solution, i.e. the set of all pairs $x,y$ such that $ax+by=c$.


Suppose that $\angles{x_1,y_1}$ is a second solution to this equation. Then notice that
$\angles{x-x_1,y-y_1}$ is a solution to the homogeneous linear Diophantine equation. Conversely,
if $\angles{x_2,y_2}$ is a solution to the homogeneous linear Diophantine equation and
$\angles{x,y}$ is a solution to the equation $ax+by=c$, then
$\angles{x+x_2, y+y_2}$ is another solution.

Putting this all together we have proven this

\begin{theorem}
Let $a,b$ be non-zero integers and let $c$ be an integer. Then the linear Diophantine equation
$ax+by=c$ has a solution iff $d\divides c$, where $d=\gcd(a,b)$ in which case there are infinitely
many solutions.

Suppose that $d\divides c$ and let $\abar,\bbar, \cbar$ be such that $a=d\abar, b=d\bbar, c=d\cbar$.

Let $x_0,y_0$ be such that $a x_0 + b y_0 = d$.

Then the general solution to the linear Diophantine equation $ax+by=c$ is the set of all
$\angles{x,y}$ in the set
$$\setof{\angles{\cbar x_0 + t\bbar, \cbar y_0 - t\abar}}{t\in\Z}.$$
\end{theorem}

\begin{in_class_example}
Find all solutions, if any, to the following linear Diophantine equations:
\begin{itemize}
\item[(a)] $12x + 18y = 20$;
\item[(b)] $12x + 18y = 30$;
\item[(b)] $3x + 5y = 7$.
\end{itemize}
\end{in_class_example}

\begin{in_class_example}
Let $a=100, b=35, d=\gcd(a,b)=5$.


Are $x=-1$ and $y=3$ the only solutions to $x\cdot a + y\cdot b = d$?

\end{in_class_example}

\bigskip

\textbf{Textbook Reading} Read section 2-3 \emph{The Linear Diophantine Equation} of 
\textbf{Number Theory} by George E. Andrews.

\bigskip

\textbf{Textbook Exercises:} From section 2-3 of Andrews do:
\begin{itemize}
\item \textbf{1. a,b,c,d,e,f} If you don't need to use the Euclidean algorithm you don't have to. But if you
do use the Euclidean algorithm, use the Extended Euclidean algorithm. Don't use back-substitution.
\end{itemize}

\newpage

\section{The Congruence Equivalence Relation}

\begin{definition}
Let $R$ be a binary relation on a set $S$. $R$ is called an \textbf{equivalence relation} iff $R$ is
\begin{enumerate}
\item reflexive $\forall x\in S \, R(x,x)$.
\item symmetric: $\forall x,y\in S\, R(x,y) \Iff R(y,x)$.
\item transitive: $\forall x,y,z\in S \, \left(R(x,y) \AND R(y,z) \right) \Implies R(x,z)$.
\end{enumerate}
\end{definition}

\begin{in_class_example}
Which of the following relations are equivalence relations?
\begin{enumerate}
\item $S$ is the set of people and $R(x,y)$ iff $x$ and $y$ are (full) siblings.
\item $S$ is the set of integers and $R(x,y)$ iff $x\leq y$.
\item $S$ is the set of points in the plane and $R(x,y)$ iff the distance between $x$ and $y$ is less than 1.
\item $S$ is the set of integers and $R(x,y)$ iff $x=\pm y$.
\end{enumerate}
\end{in_class_example}

\begin{definition}
Let $R$ be an equivalence relation on a set $S$. Let $a\in S$. Then $[a]_R=\setof{b\in S}{R(a,b)}$.
$[a]_R$ is called the \emph{equivalence class} of $a$.
\end{definition}

\begin{in_class_example}
Equivalence classes of the relation $R(x,y)$ iff $x=\pm y$.
\end{in_class_example}

\begin{in_class_example}
Equivalence relations on a deck of playing cards.
\end{in_class_example}

\begin{definition}
Let $S$ be a set. A \emph{partition} of $S$ is a collection $\cP$ of non-empty, disjoint, subsets of $S$ such that the
union of all of sets in $\cP$ is equal to  $S$.
\end{definition}

\begin{lemma}
Let $R$ be an equivalence relation on a set $S$. Then the set of equivalence classes of $R$ form a partition of $S$.
\end{lemma}

\begin{in_class_example}
Example with the equivalence relations on a deck of playing cards.
\end{in_class_example}

\begin{definition}
Let $R$ be an equivalence relation on a set $S$. Let $A\subset S$ be one of the equivalence classes. Then a \emph{representative} of $A$ is any member of $A$,
i.e. any $a\in S$ such that $[a]_R=A$.
\end{definition}

\begin{definition}
Let $R$ be an equivalence relation on a set $S$. Then a \emph{complete set of representatives} for the equivalence relation is
a set $X\subset S$ such that for each equivalence class of $A$ of $R$ there is excactly one representative of $A$ in $X$.
\end{definition}

\begin{in_class_example}
Example with the equivalence relations on a deck of playing cards.
\end{in_class_example}

\begin{definition}
Let $n$ be a positive integer. Then $\equiv_n$ is the equivalence relation defined by $x\equiv_n y$ iff $n\divides (x-y)$.
\end{definition}

$\equiv_n$ is an equivalence relation on $\Z$.

\bigskip

Instead of $x\equiv_n y$ people usually write $x\equiv y \pmod{n}$.
We say $x$ is \emph{congruent} to $y \pmod{n}$.

\bigskip

Let $n$ be a positive integer.  Let $a\in Z$. Then $[a]_n$ means the equivalence
class of $a$ under the equivalence relation of congruence $\pmod n$. If $n$ is
clear from context we write just $[a]$. 

$$[a]_n = \setof{a + ny}{y\in\Z}.$$

$[a]_n$ is called the \emph{residue class} of $a \pmod n$.

$a$ is a \emph{representative} of the residue class.

\bigskip

\begin{definition}
A complete set of representatives for the equivalence relation of congruence $\pmod n$ is known as a
\emph{complete residue system} $\pmod n$.
\end{definition}

\begin{lemma}
The equivalence relation of congurence $\pmod n$ has exactly $n$ equivalence classes and the set
$\singleton{0,1,2,\cdots, n-1}$ is a complete residue system.
\end{lemma}


\textbf{Textbook Reading} Read Sections 2.1 and 2.2 of Shoup.

\textbf{Textbook Exercises:} Do exercise 2.1, 2.2, 2.3, 2.5
of \emph{Shoup}.

\newpage

\section{The Ring $\Z/(n)$}

\begin{definition}
A \emph{commutative ring} is a 5-tuple $\left(S,+,\times,0,1,\right)$ such that:
\begin{enumerate}
\item $S$ is a non-empty set,
\item $+$ and $\times$ are binary operations on $S$,
\item $0,1\in S, 0\not=1$,
\item $+$ is associative and commutative, $0$ is an additive identity,
\item every $x\in S$ has an additive inverse named $-x$,
\item $\times$ is associative and commutative, $1$ is a multiplicative identity,
\item $\times$ distributes over $+$.
\end{enumerate}
\end{definition}

We will often abuse notation and refer to $S$ as the ring instead of $\left(S,+,\times,0,1,\right)$.

So far our only example of a commutative ring is $\Z$ (along with the usual $+$, $\times$, $0$ and $1$.) 

\begin{definition}
Let $\left(S,+,\times,0,1,\right)$ be a commutative ring. Then an \emph{ideal} of $S$ is a subset $I\subseteq S$ such that
\begin{enumerate}
\item $I\not=0$,
\item $I$ is closed under addition: $\forall x,y\in I, \, x+y\in I$.
\item $I$ is closed under scalar multiplicatoin: $\forall x\in I \, \forall y \in S, \, xy \in I$.
\end{enumerate}
\end{definition}

So far our only examples of ideals are the principal ideals $(n) \subseteq \Z$.

\begin{lemma}
Let $I$ be an ideal of the ring $S$. Consider the binary relation on $S$ defined by $x\equiv_I y \Iff x - y \in I$.
then $\equiv_I$ is an equivalence relation.
\end{lemma}
\begin{proof} \quad \\

\textbf{reflexive:} For all $x\in S, x-x\in I$.

\textbf{symmetric:} For all $x,y\in S, x-y = -(y-x)$.

\textbf{transitive:} For all $x,y,z\in S, x-z=(x-y)+(y-z)$.
\end{proof}

\begin{lemma}
Let $I$ be an ideal of the ring $S$. Let $a\in S$. Then
$$[a]_I=\setof{a+x}{x\in I} = I+x.$$
\end{lemma}
\begin{proof}
If $x\in I$ then $a+x\in [a]_I$ because $(a+x)-a \in I$.

Conversely, suppose $b\in [a]_I$. Let $x=b-a$. Then $x\in I$ and $b=a+x$.
\end{proof}

\begin{example}
In the ring $\Z$ consider the ideal $I=(n)$. Let $r\in\Z, 0\leq r < n$. Then 
$[r]_n = (n) + r = \setof{kn+r}{k\in\Z}$.
\end{example}


\begin{lemma}
\label{RingOperationsCompatibleWithIdeals}
Let $I$ be an ideal of the ring $S$. Let $a,\aprime,b,\bprime\in S$. Suppose that $a\equiv_I\aprime$ and $b\equiv_I\bprime$.
Then
\begin{enumerate}
\item $a+b\equiv_I \aprime+\bprime$
\item $-a\equiv_I -\aprime$
\item $ab \equiv_I \aprime\bprime$
\end{enumerate}
\end{lemma}
\begin{proof}
$(a+b)-(\aprime+\bprime)=(a-\aprime)+(b-\bprime) \in I$.

$-a - (-\aprime) = \aprime-a \in I$.

Suppose $\aprime = a + x$ and $\bprime = b + y$ with $x,y\in I$. Then
$\aprime\bprime = ab +xb + ya + xy$ and $xb + ya + xy \in I$.
\end{proof}

\begin{definition}
Let $I$ be an ideal of the ring $S$. Then $S/I$ (pronounced $S$-mod-$I$) is the set of equivalence classes under $\equiv_I$.
$S/I=\setof{[a]_I}{a\in S}$.
\end{definition}

\begin{example}
$\Z/(6)$ a.k.a $\Z/6\Z$.
\end{example}

\begin{theorem}
\label{RingModIdealIsRing}
Let $I$ be an ideal of the ring $S$. Then $S/I$ is also a ring under the following operations:
\item $[a]+[b] = [a+b]$.
\item $[0]=I$ is the additive identity
\item $[a][b] = [ab]$.
\item $-[a] = [-a]$
\item $[1]$ is the multiplicative identity.
\end{theorem}
\begin{proof}
The operations are well-defined by the previous lemma. We need to see that the arithmetic properties defining a ring are true:

$+$ is commutative: $[a+b]=[b+a]$.

$+$ is associative: $[a+b] + [c] = [a+b+c] = [a] + [b+c]$.

$\times$ is commutative: $[ab] = [ba]$.

$\times$ is associative: $[ab][c] = [abc] = [a][bc]$.

$\times$ distributes over $+$: $[a]\left([b] + [c] \right) =[a][b+c] = [a(b+c)] = [ab+ac] = [ab] + [ac] =[a][b] + [a][c]$.

$[0]=I$ is the additive identity: $[a] + [0] = [a+0] = [a]$

$[1]$ is the multiplicative identity: $[a][1]=[a\cdot 1] = [a]$.
\end{proof}

\begin{example}
$\Z/(6)$ is a ring.
\end{example}


\begin{definition}
Let $\left(S,+,\times,0,1,\right)$ and $\left(\dot{S},\dotplus,\dottimes,\dot{0},\dot{1},\right)$ be two rings.
An \emph{isomorphism} between the two rings is a function $\pi:S\map\dot{S}$ such that
\begin{enumerate}
\item $\pi$ is one-to-one and onto.
\item $\pi(a+b) = \pi(a) \dotplus \pi(b)$ for all $a,b\in S$
\item $\pi(a\times b) = \pi(a) \dottimes \pi(b)$ for all $a,b\in S$
\item $\pi(0) = \dot{0}$
\item $\pi(1) = \dot{1}$
\end{enumerate}
\end{definition}

\begin{definition}
Let $n>1$ be an integer. The $\Z_n = \singleton{0,1,2,\cdots, n-1}$.
\end{definition}

\begin{lemma}
Let $\dotplus$ and $\dottimes$ be the binary operations on $\Z_n$ defined by
$$a\dotplus b = a+b \bmod n$$
and
$$a\dottimes b = ab \bmod n.$$
Then $\left(\Z_n,\dotplus,\dottimes,0,1\right)$ is a commutative ring. Furthermore
let ${\pi:\Z/(n) \map \Z_n}$ be given by ${\pi([a]_n) = a\bmod n}$. Then $\pi$ is an isomorphism.
\end{lemma}

\begin{proof}
By exercise 2.3 of Shoup, $a\equiv b \pmod{n} \Iff a\bmod n = b \bmod n$. This means that
$[a]_n = [b]_n \Iff \pi([a]_n) = \pi([b]_n)$.


This tells us that
$\pi$ is well-defined and one-to-one. Also since $\Z_n$ is a complete set of residues, $\pi$ is onto.


We will show that $\pi$ is an isomorphism and that will also show that $\Z_n$ is a ring since
it is isomorphic to the ring $\Z/(n)$.


Let $a,b\in Z$. Let $a=q_1n + r_1$ and $b=q_2n+r_2$ with $r_1 = a\bmod n$ and $r_2=b\bmod n$.

So $\pi([a]_n) = r_1$ and $\pi([b]_n) = r_2$. Also $a\equiv r_1 \bmod n$ and $b\equiv r_2 \bmod n$

\bigskip

$\pi([a]_n+[b]_n) = \pi([r_1]_n + [r_2]_n) = (r_1+r_2) \bmod n = \pi([a]_n) \dotplus \pi([b]_n)$.

\bigskip

$\pi([a]_n [b]_n) = \pi([r_1]_n  [r_2]_n) = (r_1 r_2) \bmod n = \pi([a]_n) \dottimes \pi([b]_n)$.

\bigskip

$\pi([0]_n) = 0$ and $\pi([1]_n)=1$.
\end{proof}

\textbf{Textbook Exercises}: Do exercise  2.4, 2.6, 2.7, 2.8 of \emph{Shoup}.

\newpage

\section{Solving Linear Congruences}

Before getting into Linear Congruences, let's briefly revisit the material from the previous section.
In the previous section we were discussing rings and ideals in the abstract. Here we revisit this
material in the more concrete setting of the integers.

\begin{theorem}
\label{ArithmeticCompatibleWithCongruence}
Let $a,b,n\in\Z$ with $n>1$. If $a\equiv\aprime \pmod n$ and $b\equiv\bprime \pmod n$ then
\begin{enumerate}
\item $a+b\equiv \aprime + \bprime \pmod n$
\item $ab \equiv \aprime\bprime \pmod n$
\item $-a \equiv -\aprime \pmod n$.
\end{enumerate}
\end{theorem}

\begin{note}
This is Theorem 2.3 from \emph{Shoup} and Theorem 4-2 from \emph{Andrews.}

This theorem says the same thing as Lemma \ref{RingOperationsCompatibleWithIdeals} from the previous section,
except that lemma was stated more abstractly in terms of ideals and rings. Even though we already proved
that lemma, we give a direct proof of the theorem here.
\end{note}

\begin{proof}
Write $a=\aprime + nx$ and $b=\bprime + ny$. Then
\begin{enumerate}
\item $a+b = \aprime + \bprime + n(x+y)$
\item $ab = \aprime\bprime + n(\aprime y + \bprime x + nxy)$
\item $-a = -\aprime + n(-x)$
\end{enumerate}
\end{proof}

One consequence of this theorem is the following 

\begin{theorem}
Let $n>1$ be an integer. Let $\Z/(n)$ be the set of $n$ residue classes $\bmod n$,
in other words the set  $\singleton{[0]_n,[1]_n,\cdots,[n-1]_n}$ of equivalence classes
under the equivalence relation $\equiv \bmod n$. Then $\Z/(n)$ is a ring under the operations
\begin{itemize}
\item $[a] + [b] \defeq [a+b]$
\item $[a][b] \defeq [ab]$
\item $-[a] \defeq [-a]$.
\end{itemize}
\end{theorem}
\begin{proof}
This is a special case of Theorem \ref{RingModIdealIsRing} from the previous section.
\end{proof}

Now we turn to the real topic of this section, solving linear congruences.

\begin{example}
Find all integers $x$ such that $36x \equiv 48 \pmod{15}$.
\end{example}

A \textbf{linear congruence} is an expression of the form
$$ax\equiv b \pmod n$$
where $a,b,n\in \Z$ and $n>1$. The goal is to find all integers $x$ that
make the congruence expression true.

\bigskip

By Theorem \ref{ArithmeticCompatibleWithCongruence}, we can replace $a$ and $b$ with
the unique elements of $\Z_p$ that they are congruent to, namely $a\bmod n$ and $b\bmod n$.

\begin{example}
So the previous example may be reduced to:
Find all integers $x$ such that $6x \equiv 3 \pmod{15}$.
\end{example}

By Theorem \ref{ArithmeticCompatibleWithCongruence} again, if $x$ is any solution 
the linear congruence $ax\equiv b \pmod n$, then so is $x+kn$ for all $k\in\Z$.
All of those solutions are congruent. So the interesting question is to find all \emph{incongruent} solutions, or
equivalently all solutions in $\Z_n$.

\begin{example}
So the previous example may be reduced to:
Find all integers $x$ with $0\leq x \leq 14$ such that $6x \equiv 3 \pmod{15}$.
\end{example}

\begin{theorem}
Let $a,b,n\in \Z$ with $n>1$. Let $d=\gcd(a,n)$. Then
\begin{enumerate}
\item The linear congruence $ax\equiv b \pmod n$ has a solution if and only if $d\divides n$.
\item If $d\divides n$ then there are $d$ incongruent solutions. Equivalently there are
$d$ solutions $x\in \Z_n$, i.e. such that $0\leq x < n$.
\item Let $\abar = a/d$, $\bbar=b/d$ and $\nbar = n/d$. Then there is a unique solution 
$x_0\in Z_{\nbar}$ to the linear
congruence $\abar x\equiv  \bbar \pmod \nbar$, and $x_0$ is also a solution to the original
congruence $ax\equiv b \pmod n$.
\item The other solutions to the original congruence besides $x_0$ are $x_0 + \nbar, x_0 + 2\nbar, \cdots x_0 + (d-1)\nbar$.
\end{enumerate}
\end{theorem}

\begin{example}
For the congruence $6x \equiv 3 \pmod{15}$, we have $d=\gcd(6, 15) = 3$. $3\divides 3$ so there
are solutions. There are 3 solutions in $\Z_{15}$.

Dividing by $d=3$ gives us $\abar=2$, $\bbar= 1$, $\nbar= 5$ and so we get
the linear congruence $2x \equiv 1 \pmod{5}$. We see that $x_0=3$ is the unique
solution. The other two solutions to the original congruence are $x=8,13$.
\end{example}

\begin{proof}
\begin{enumerate}
\item $ax\equiv b \pmod n$ has a solution if and only if there exists $x,y$ such that
$ax - b = ny$ iff there is a solution to the linear Diophantine equation $ax - ny = b$,
iff $d= \gcd(a,n) \divides b$. So now suppose $d\divides b$ and let $\abar,\bbar,\nbar$
be as in the statement of the theorem.
\item Let $x_0$ be a solution. $x_1$ is another solution iff $a(x_1 - x_0) \equiv 0 \pmod n$.
In other words, $x_1 = x_0 + z$ where $az \equiv 0 \pmod n$.

$n\divides az$ iff $\nbar\divides \abar z$ iff $\nbar\divides z$ (since $\nbar$ and $\abar$ are relatively prime). 
So $z$ is a multiple of $\nbar$ and there are $d$ multiples of $\nbar$ between $0$ and $n$, namely,
$z=0,\nbar,2\nbar,\cdots (d-1)\nbar$.

\item There is a unqiue solution in $\Z_{\nbar}$ to $\abar x \equiv \bbar \pmod \nbar$ by parts 1 and 2
since $\gcd(\abar,\nbar) = 1$ and $1\divides \bbar$. Let $x_0$ be that unique solution.
Since $\abar x_0 -\bbar = k\nbar$, multiplying by $d$ we get $ax_0 - b = kn$ and so
$ax_0 \equiv b \pmod n$.

\item We already proved part (4) in the step (2).
\end{enumerate}
\end{proof}

Notice that one consequence of the theorem is the following:

\begin{corollary}
Let $a,n\in \Z$ with $n>1$. Then there is a $c\in\Z$ such that $ac=1 \pmod n$ iff $\gcd(a,n) = 1$. Furthermore if $\gcd(a,n)=1$
there is a unique such $c$ with $0\leq c < n$.
\end{corollary}

\begin{definition}
Let $a,c, n\in \Z$ with $n>1$. Suppose that $ac=1 \pmod n$. Then $a$ and $c$ are called \emph{multiplicative inverses} $\mod n$.
The corollary says that $a$ has a multiplicative inverse $\mod n$ iff $\gcd(a,n)=1$ and in that case it has a unique multiplicative
inverse up to congruence $\mod n$.
\end{definition}

\begin{numbered_example}
3 has a unique inverse $\mod 10$, namely 7. 4 does not have an inverse $\mod 10$.
\end{numbered_example}

\begin{definition}
Let $R$ be a commutative ring and let $a\in R$. Then $a$ is called a \textbf{unit} iff there is a $c\in R$ such that $ac=1$ in $R$.
\end{definition}

In other words a unit is an element of a ring that has a multiplicative inverse. The Corollary says that $a$ is a unit of $\Z_n$ iff
$\gcd(a,n) = 1$.

\begin{definition}
Let $R$ be a commutative ring. Then $R^*$ is the set of all units of $R$. $R^*$ always contains at least $1$ and $-1$
and may contain other elements of $R$ also. For the ring $\Z$, $\Z^*$ contains only 1 and -1. But for the ring $\Z_n$,
$\Z^*_n$ contains all of the integers in $\Z_n$ that are relatively prime to $n$.
\end{definition}

\begin{numbered_example}
Find the elements of $\Z_{10}^*$. Solution: The units of $\Z_{10}$ are the integers between 0 and 9 that are relatively prime to 10.
Thus $\Z_{10}^*=\singleton{1,3,7,9}$.
\end{numbered_example}

\begin{definition}
A maximal set of incongruent integers that are relatively prime to $n$ is called a \textbf{reduced residue system} $\mod n$.
\end{definition}

Thus $\Z_n^*$ constitutes a reduced residue system $\mod n$. For example $\singleton{1,3,7,9}$ is a reduced residue system $\mod$ 10.
But so is $\singleton{1,13,27,39}$.


\textbf{Textbook Reading:} Section 2.3 of \emph{Shoup}, \emph{Solving linear congruences}.

\bigskip

\textbf{Textbook Reading: } Section 4-2 of \emph{Andrews}, \emph{Residue Systems}.
\textbf{Textbook Exercises}: Do exercises 1 and 2 on page 55 of \emph{Andrews}.

\bigskip

\textbf{Textbook Reading: } Section 5-1 of \emph{Andrews}, \emph{Linear Congruences}.
\textbf{Textbook Exercises}: Do exercises 1,2 and 3 on page 61 of \emph{Andrews}.

\newpage

\section{The Chinese Remainder Theorem}

\begin{definition}
If $A$ and $B$ are sets, then their \emph{cross-product} or \emph{cartesian prodct}
is the set of all ordered pairs whose first element comes from $A$ and whose second
element comes form $B$.
$$A\times B = \setof{(a,b)}{a\in A \And b\in B}.$$
\end{definition}

\begin{example}
If $A=\Z_9$ and $B=\Z_4$ then $A\times B$ contains 36 elements:
$(0,0), (0,1), (0,2), (0,3), (1,0), (1,1), (1,2), (1,3), \cdots , (8,0), (8,1), (8,2), (8,3)$.
\end{example}

\begin{fact}
If $R_1$ and $R_2$ are commutative rings then $R_1\times R_2$ is a commutative ring
under the operations of componentwise addition and multiplication. The
zero element (i.e. additive identity) is $(0_1,0_2)$ where $0_1$ is the zero 
element of $R_1$ and $0_2$ is the zero element of $R_2$. The one element (i.e.
multiplicative identity) is $(1_1,1_2)$ where $1_1$ is the one 
element of $R_1$ and $1_2$ is the one element of $R_2$.
\end{fact}

\begin{example}
$\Z_9 \times \Z_4$ is a ring. In this ring we have, for example, the following
addition and multiplication: $(7,2) \dotplus (4,3) = (2,1)$.
$(4,3) \dottimes (5,3) = (2,1)$.
\end{example}

A major theme we are now going to turn to in this course is the structure of
the rings $\Z_n$ and of the corresponding groups of units $\Z_n^*$.

Recall that $\Z_n\isomorphic \Z/(n)$ so we will often use the two notations interchangably.

When we analyze the $\Z_n$ or $\Z/(n)$ we consider 3 different types of $n$:
\begin{enumerate}
\item[type 1.] $\Z/(p)$ for $p$ a prime.
\item[type 2.]  $\Z/(p^k)$ for $p$ a prime.
\item[type 3.] $\Z/(n)$ for $n$ divisible by two different primes.
\end{enumerate}

The Chinese Remainder Theorem will help us with type 3. It will tell us that
a ring of type 3 is just a Cartesian product of rings of type 2. So once we 
understand the $\Z/(p^k)$ we will understand all $\Z/(n)$.

There is a concrete and an abstract way to look at the Chinese Remainder Theorem.
The abstract way to look at it is that we will show the following:

\bigskip

If $\gcd(n,m)=1$ then $\Z/(nm)\isomorphic \Z/(n) \times \Z/(m)$.

\bigskip

For example, $36=3^2\cdot 2^2$. So $n=36$ is of type 3. It is of type
$n=p^2q^2$, where $p,q$ are primes.

The Chinese Remainder Theorem will tell us that

$\Z/(36) \isomorphic \Z/(9) \times \Z/(4)$.

\bigskip

The concrete way of viewing the Chinese Remainder Theorem is:

\bigskip

Suppose $\gcd(n,m) = 1$. Let $a,b\in\Z$. Then there is an $x\in \Z$ such that

\begin{align*}
x &\equiv a \pmod n\\
x &\equiv b \pmod m
\end{align*}

and $x$ is unique modulo $nm$.

\bigskip

For example, there is a unique $x$ modulo 36 such that

\begin{align*}
x &\equiv 5 \pmod 9 \\
x &\equiv 3 \pmod 4 \\
\end{align*}

The solution is $x=23$.

\bigskip

Why are the two ways of looking at the Chinese Remainder Theorem related? Consider
the map $\pi:\Z/(36) \map \Z/(9)\times\Z/(4)$ given by $\pi(x) = \left(x\bmod 9, x\bmod 4 \right)$.

For example $\pi(10) = (1,2)$, $\pi(11) = (2,3)$, $\pi(12) = (3, 0)$. The concrete version of the
Chinese Remainder Theorem guarantees that this map is onto. For example if we want to see that
$(5,3)$ is in the range of $\pi$, the example above tells us that $\pi(23) = (5,3)$.

\bigskip

So far we have been looking at two simultaneous linear congruences.
The Chinese Remainder Theorem allows any finite number of simultaneous linear congruences.

\begin{definition}
Let $n_1,n_2,\cdots,n_K\in\Z$. We say that the $n_i$ are \emph{pairwise relatively prime}
iff whenever $1\leq i < j \leq K$, $\gcd(n_i,n_j) = 1$.
\end{definition}

\begin{theorem}[Chinese Remainder Theorem] Let $n_1,n_2,\cdots,n_K$ be integers greater
than 1 that are pairwise relatively prime. Let $a_1,a_2,\cdots,a_K$ be any integers. Then there is a solution to the
system of simultaneous linear congruences

\begin{align*}
x &\equiv a_1 \pmod{n_1} \\
x &\equiv a_2 \pmod{n_2} \\
  &\vdots \\
x &\equiv a_K \pmod{n_K}.
\end{align*}

Furthermore the solution is unique module $n=n_1 n_2 \cdots n_K$.

\end{theorem}

To prove this we start with a special case of it.

\begin{lemma} Let $n_1,n_2,\cdots,n_K$ be integers greater
than 1 that are pairwise relatively prime. Then there is a solution to the
system of simultaneous linear congruences

\begin{align*}
x &\equiv 1 \pmod{n_1} \\
x &\equiv 0 \pmod{n_2} \\
  &\vdots \\
x &\equiv 0 \pmod{n_K}
\end{align*}

\end{lemma}
\begin{proof}
Let $m = n_2 n_3 \cdots n_k$. Since $n_1$ is relatively prime to $n_2, n_3,\cdots, n_K$,
$n_1$ is relatively prime to $m$. Thus there are integers $r,s$ such that
$$r n_1 + s m = 1.$$
Let $x=sm$. Then $n_2\divides x, n_3\divides x, \cdots n_K \divides x$ and 
$x\equiv 1 \pmod{n_1}$. So $x$ solves the system of linear congruences in the lemma.
\end{proof}

\begin{proof} (Of the Chinese Remainder Theorem.)
By the lemma, let $x_1$ be such that

\begin{align*}
x_1 &\equiv 1 \pmod{n_1} \\
x_1 &\equiv 0 \pmod{n_2} \\
  &\vdots \\
x_1 &\equiv 0 \pmod{n_K}
\end{align*}

Similarly let $x_2$ be such that 

\begin{align*}
x_2 &\equiv 0 \pmod{n_1} \\
x_2 &\equiv 1 \pmod{n_2} \\
  &\vdots \\
x_2 &\equiv 0 \pmod{n_K}
\end{align*}

In general, for $1\leq i \leq K$, let $x_i\in\Z$ be such that
$$x_i\equiv 1 \pmod {n_i}$$
and
$$x_i\equiv 0 \pmod {n_j}$$
for $j\not=i$.

Then let $x=x_1 a_1 + x_2 a_2 + \cdots + x_K a_K$.

Then for  $1\leq i \leq K$, $x\pmod{n_i} = a_i$. So $x$
is a solution to the system of linear congruences.

To see that the solution is unique mod $n$. suppose that $\xprime$ is also a solution.
Then $x\equiv \xprime \pmod {n_1}, x\equiv \xprime \pmod {n_2}, \cdots, x\equiv \xprime \pmod {n_K}$,
so $x \equiv \xprime \pmod n$.

\end{proof}

\begin{theorem}[The Chinese Remainder Map Theorem]
Let $n_1,n_2,\cdots,n_K$ be integers greater
than 1 that are pairwise relatively prime. Let $n=n_1 n_2 \cdots n_K$. Then
$$\Z_n \isomorphic \Z_{n_1} \times \Z_{n_2} \times \cdots \times \Z_{n_K}.$$

The map $\pi:\Z_n \map \Z_{n_1} \times \Z_{n_2} \times \cdots \times \Z_{n_K}$ given by
$$\pi(x) = \left(x \bmod n_1, x\bmod n_2, \cdots , x\bmod n_K\right)$$
is an isomorphism.
\end{theorem}
\begin{proof}
The Chinese Remainder Theorem tells us exactly that $\pi$ is a bijection. So we need to
see that it preserves addition, multiplication, zero, and one.

\bigskip

$\pi(0) = (0,0,\cdots,0)$ and $\pi(1) = (1,1,\cdots, 1)$, so $\pi$ preserves zero and one.

\bigskip

We need to see that
$$\pi(x\dotplus y) =  \pi(x) \dotplus \pi(y)$$
and
$$\pi(x\dottimes y) = \pi(x) \dottimes \pi(y) $$
where $\dotplus$ and $\dottimes$ on the left refer to addition and multiplication in $\Z_n$ and
$\dotplus$ and $\dottimes$ on the right refer to addition and multiplication in
$\Z_{n_1} \times \Z_{n_2} \times \cdots \times \Z_{n_K}$.

\bigskip

\begin{align*}
\left( (x+y) \bmod n \right) \bmod n_i  &= (x+y) \bmod n_i \\
  &= (x \bmod n_i + y \bmod n_i) \bmod n_i.
\end{align*}
This shows that every coordinate of $\pi(x\dotplus y)$ is the same as the corresponding coordinate of
$\pi(x) \dotplus \pi(y)$. This shows that $\pi(x\dotplus y) =  \pi(x) \dotplus \pi(y)$.

The argument is similar for multiplication.
\end{proof}

\begin{in_class_example}
Solve
\begin{align*}
x &\equiv 1 \pmod 3 \\
x &\equiv 4 \pmod 5 \\
x &\equiv 6 \pmod 7
\end{align*}
\end{in_class_example}

We can also solve a more general type of problem using the Chinese Remainder Theorem. We can solve problems of the form

\begin{align*}
a_1 x &\equiv b_1 \pmod{n_1} \\
a_2 x &\equiv b_2 \pmod{n_2} \\
  &\vdots \\
a_K x &\equiv b_K \pmod{n_K}.
\end{align*}

where $n_1,n_2,\cdots,n_K$ are integers greater than 1 that are pairwise relatively prime, 
$b_1,b_2,\cdots,b_K$ are any integers, and $\gcd(a_i,n_i)=1$ for each $i$. This is because
then each $a_i$ has an inverse mod $n_i$ and so we can multiply by the inverse and
reduce the problem to the previous kind.

\begin{in_class_example}
Solve
\begin{align*}
2x &\equiv 1 \pmod 3 \\
3x &\equiv 2 \pmod 4 \\
6x &\equiv 17 \pmod {25}
\end{align*}
\end{in_class_example}

\textbf{Textbook Reading:} Section 2.4 of \emph{Shoup}, \emph{The Chinese Remainder Theorem}.

\textbf{Textbook Exercises}: Do exercise 2.14.

\bigskip

\textbf{Textbook Reading:} Section 2.5 of \emph{Shoup}, \emph{Residue Classes}.

\textbf{Textbook Exercises}: Do exercises 2.20, 2.21.

\bigskip

\textbf{Textbook Reading:} Section 5-3 of \emph{Andrews}, \emph{The Chinese Remainder Theorem}.

\textbf{Textbook Exercises}: Do exercise 1 parts a,b,c,d, exercise 2, exercise 5.

\bibliographystyle{amsalpha}

\bibliography{math}

\end{document}

